angular.module("myApp",["gameServices"]).factory("gameLogic",function(){"use strict";function a(a){var b=[];
switch(a){case 2:b=[{p:"R",c:"vert",i:0},{p:"G",c:"vert",i:1}];
break;case 3:b=[{p:"R",c:"vert",i:0},{p:"G",c:"left",i:1},{p:"B",c:"right",i:1}];break;case 4:b=[{p:"Y",c:"left",i:0},{p:"G",c:"left",i:1},{p:"B",c:"right",i:1},{p:"W",c:"right",i:0}];break;
case 6:b=[{p:"R",c:"vert",i:0},{p:"Y",c:"left",i:0},{p:"G",c:"left",i:1},{p:"K",c:"vert",i:1},{p:"B",c:"right",i:1},{p:"W",c:"right",i:0}];break;default:throw new Error("Illegal number of players: "+r)}return b}function b(a){r=a}function c(){for(var b=[[" "," "," "," "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," ","a"," "," "," "," "," "," "," "," "," "],[" "," "," "," "," ","a","a"," "," "," "," "," "," "," "," "],[" "," "," "," "," ","a","a","a"," "," "," "," "," "," "," "],[" "," "," "," "," ","a","a","a","a"," "," "," "," "," "," "," "," "," "],[" ","a","a","a","a","a","a","a","a","a","a","a","a","a"," "],[" "," ","a","a","a","a","a","a","a","a","a","a","a","a"," "],[" "," "," ","a","a","a","a","a","a","a","a","a","a","a"," "],[" "," "," "," ","a","a","a","a","a","a","a","a","a","a"," "],[" "," "," "," "," ","a","a","a","a","a","a","a","a","a"," "],[" "," "," "," "," ","a","a","a","a","a","a","a","a","a","a"," "],[" "," "," "," "," ","a","a","a","a","a","a","a","a","a","a","a"," "],[" "," "," "," "," ","a","a","a","a","a","a","a","a","a","a","a","a"," "],[" "," "," "," "," ","a","a","a","a","a","a","a","a","a","a","a","a","a"," "],[" "," "," "," "," "," "," "," "," "," ","a","a","a","a"," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," ","a","a","a"," "],[" "," "," "," "," "," "," "," "," "," "," "," ","a","a"," "],[" "," "," "," "," "," "," "," "," "," "," "," "," ","a"," "],[" "," "," "," "," "," "," "," "," "," "," "," "," "," "," "]],c=a(r),d=0;r>d;d++)for(var e=c[d].p,f=q[c[d].c][c[d].i],g=0;10>g;g++)b[f[g][0]][f[g][1]]=e;return b}function d(b){return a(r)[b].p}function e(b){for(var c=a(r),d=0;r>d;d++){for(var e=0,f=q[c[d].c][1-c[d].i],g=0;10>g&&b[f[g][0]][f[g][1]]===c[d].p;g++)e++;if(10===e)return d}return-1}function f(a,b){for(var c=d(b),e=[],f=1;18>f;f++)for(var g=1;g<a[f].length;g++)a[f][g]===c&&e.push({row:f,col:g});return e}function g(a,b,c){return" "===c[a][b]||void 0===c[a][b]?!1:!0}function h(a,b,c,d){return Math.abs(a-c)+Math.abs(b-d)===1||c===a+1&&d===b+1||c===a-1&&d===b-1?!0:!1}function i(a,b,c){var d=[];return c[a]&&" "!==c[a][b+1]&&"a"!==c[a][b+1]&&"a"===c[a][b+2]&&d.push([a,b+2]),c[a+1]&&" "!==c[a+1][b+1]&&"a"!==c[a+1][b+1]&&"a"===c[a+2][b+2]&&d.push([a+2,b+2]),c[a+1]&&" "!==c[a+1][b]&&"a"!==c[a+1][b]&&"a"===c[a+2][b]&&d.push([a+2,b]),c[a]&&" "!==c[a][b-1]&&"a"!==c[a][b-1]&&"a"===c[a][b-2]&&d.push([a,b-2]),c[a-1]&&" "!==c[a-1][b-1]&&"a"!==c[a-1][b-1]&&"a"===c[a-2][b-2]&&d.push([a-2,b-2]),c[a-1]&&" "!==c[a-1][b]&&"a"!==c[a-1][b]&&"a"===c[a-2][b]&&d.push([a-2,b]),d}function j(a,b){for(var c=0;c<a.length;c++)if(a[c][0]===b[0]&&a[c][1]===b[1])return!0;return!1}function k(a,b,c,d,e){function f(a){if(a[0]===c&&a[1]===d)return!0;if(!g(a[0],a[1],e))return!1;h.push(a);for(var b=i(a[0],a[1],e),k=!1,l=0;l<b.length;l++)j(h,b[l])||(k|=f(b[l]));return k||h.pop(),k}var h=[];return f([a,b])?h:!1}function l(a,b){for(var c=[],d=f(a,b),e=0;e<d.length;e++)for(var g=d[e],h=1;18>h;h++)for(var i=1;i<a[h].length;i++)try{c.push(m(g.row,g.col,h,i,b,a))}catch(j){}return c}function m(a,b,f,i,j,l){if(void 0===l&&(l=c()),!g(f,i,l))throw new Error("One can not make a move outside of the board!");if("a"!==l[f][i])throw new Error("One can only make a move in an empty position!");var m=[];if(!h(a,b,f,i)&&(m=k(a,b,f,i,l))===!1)throw new Error("One can only make a single step adjacent move or a multi-step move consisting of adjacent hops");var n=angular.copy(l);if(n[f][i]=d(j),n[a][b]!==n[f][i])throw new Error("The original checker is not the expected one!");n[a][b]="a";var o=e(n),p={};if(-1!==o){var q=Array.apply(null,new Array(r)).map(Number.prototype.valueOf,0);q[o]=1,p={endMatch:{endMatchScores:q}}}else p={setTurn:{turnIndex:++j%r}};return[p,{set:{key:"board",value:n}},{set:{key:"delta",value:{oldrow:a,oldcol:b,row:f,col:i}}},{set:{key:"hops",value:m}}]}function n(a,b,c){for(var d=[],e=b,f=a,g=0;g<c.length;g++){var h=c[g],i=m(h.oldrow,h.oldcol,h.row,h.col,f,e.board),j={board:i[1].set.value,delta:i[2].set.value};d.push({stateBeforeMove:e,stateAfterMove:j,turnIndexBeforeMove:f,move:i,comment:{en:h.comment}}),e=j,f=i[0].setTurn.turnIndex}return d}function o(){return n(0,{},[{oldrow:6,oldcol:4,row:6,col:5,comment:"First player usually might move a topmost piece one step towards its opposite corner"},{oldrow:11,oldcol:14,row:11,col:13,comment:"Second player gets a similar move from his own corner"},{oldrow:6,oldcol:2,row:6,col:6,comment:"Two consecutive hops takes place during the first player's turn. A hop consist of jumping over a single adjacent piece, only the diagonal direction is allowed"},{oldrow:12,oldcol:15,row:12,col:13,comment:"Second player also provides a single hop from the middle of his second line, and jumps one more step based on one of the piece in his topmost line"},{oldrow:7,oldcol:4,row:7,col:5,comment:"One step in its adjacent empty position towards the opposite cornerï¼Œ A player may not combine hopping with a single move"},{oldrow:13,oldcol:14,row:11,col:12,comment:"A single hop based on his own pieces"},{oldrow:5,oldcol:2,row:7,col:6,comment:"Two consecutive hops based on his own pieces"},{oldrow:11,oldcol:12,row:11,col:11,comment:"One step in its adjacent empty position in order to provide other pieces a better chance to move more steps"},{oldrow:7,oldcol:6,row:8,col:7,comment:"First player gives a single move on the piece's adjacent empty space"},{oldrow:13,oldcol:16,row:11,col:10,comment:"Second player has a three-step-hops move towards the opposite corner, The more distance your piece takes place, the better chance you win"},{oldrow:5,oldcol:1,row:5,col:2,comment:"First player moves the innermost piece one step to prepare for another long jump"},{oldrow:11,oldcol:10,row:10,col:9,comment:"Second player takes one move to form a longer bridge to prepare for a long jump as well"},{oldrow:5,oldcol:2,row:9,col:8,comment:"First player provides a three-step-hops, now arround the new location, there are two kind of pieces"},{oldrow:12,oldcol:14,row:10,col:8,comment:"Second player takes a three-step-hops again"},{oldrow:9,oldcol:8,row:13,col:16,comment:"First player makes use of his opponent's pieces, provides a four-step-hops and finally located in his opponent's corner, He'll win the game if all his pieces firstly place in the opposite corner"},{oldrow:11,oldcol:15,row:11,col:14,comment:"Second player makes one step move"},{oldrow:5,oldcol:4,row:13,col:14,comment:"First player makes a five-step-hops based on both his and his opponent's pieces"},{oldrow:11,oldcol:14,row:5,col:2,comment:"Second player makes a even better six-step-hops based on both sides' pieces"},{oldrow:6,oldcol:6,row:7,col:6,comment:"First player takes a one step move, wants to block the 'bridge' as well as to prepare for the next long jump"},{oldrow:13,oldcol:17,row:11,col:15,comment:"Second player gives a hop from the innermost corner"},{oldrow:7,oldcol:6,row:11,col:14,comment:"First player takes a four-step-hops and settles another his piece in his opposite corner"},{oldrow:10,oldcol:14,row:10,col:10,comment:"Second player takes a three-step-hops"},{oldrow:6,oldcol:5,row:7,col:6,comment:"First player provides a single move"},{oldrow:10,oldcol:8,row:9,col:8,comment:"Second player also takes a single move to block his opponent's further jump"},{oldrow:13,oldcol:16,row:13,col:17,comment:"First player occupied the innermost corner with one single move, in most case this piece will never move again"},{oldrow:10,oldcol:10,row:6,col:4,comment:"Second player makes some progress, with a four-step-hops, another piece reaches the opposite corner"},{oldrow:13,oldcol:14,row:13,col:16,comment:"First player gets a hop in his opposite corner"},{oldrow:11,oldcol:13,row:11,col:12,comment:"Second player gives a single move before jumping "},{oldrow:8,oldcol:4,row:7,col:4,comment:"First player gives a single move before jumping"},{oldrow:9,oldcol:8,row:9,col:7,comment:"Second player moves away the blocker on 'bridge'"},{oldrow:7,oldcol:6,row:11,col:10,comment:"First player forward a piece on the bridge, but still be blocked by another piece, one can not jump through two or more adjacent pieces"},{oldrow:11,oldcol:12,row:12,col:12,comment:"Second player moves his bridge blocker one step away, try to use another diagonal way to jump, but this is a mistake, his opponent now can make use of the whole 'bridge'"},{oldrow:11,oldcol:10,row:13,col:14,comment:"First player gives a two-step-hops, another piece has been settled in the corner"},{oldrow:12,oldcol:12,row:8,col:6,comment:"Second player forward his piece by three-step-hops, but still blocked by his own piece"},{oldrow:7,oldcol:4,row:11,col:12,comment:"First player gives a four-step-hops"},{oldrow:5,oldcol:2,row:5,col:1,comment:"Second player moves a piece to the innermost corner"},{oldrow:11,oldcol:12,row:11,col:13,comment:"First player takes a single move to form a better 'bridge'"},{oldrow:13,oldcol:15,row:12,col:14,comment:"Second player provides a single move"},{oldrow:11,oldcol:14,row:12,col:15,comment:"First player also maneuvers his piece in the opposite corner to make room for newly imcoming pieces"},{oldrow:12,oldcol:14,row:10,col:8,comment:"Second player gives a three-step-hops on the bridge, but still be blocked"},{oldrow:7,oldcol:3,row:7,col:4,comment:"First player makes a single move on his side of 'bridge'"},{oldrow:6,oldcol:4,row:6,col:2,comment:"Second player gives a hop to clear the end of 'bridge'"},{oldrow:7,oldcol:4,row:11,col:14,comment:"First player provides a long consecutive jumps from the beginning of the 'bridge' to the end"},{oldrow:8,oldcol:6,row:6,col:4,comment:"Second player makes a one-step-hop to clean the end of his 'bridge'"},{oldrow:11,oldcol:14,row:12,col:14,comment:"First player makes a hop to clean his end of 'bridge' as well"},{oldrow:12,oldcol:16,row:10,col:14,comment:"Second player makes a hop"},{oldrow:6,oldcol:3,row:7,col:4,comment:"First player gives a single move before a long jump"},{oldrow:6,oldcol:4,row:6,col:3,comment:"Second player provides a hop to make room for a new long jump"},{oldrow:7,oldcol:4,row:11,col:14,comment:"First player makes a long jump, it's cool"},{oldrow:6,oldcol:3,row:5,col:2,comment:"Second player makes a single move"},{oldrow:12,oldcol:14,row:13,col:15,comment:"First player also makes a single move"},{oldrow:10,oldcol:8,row:6,col:4,comment:"Second player gets a two-step-hops and reaches the opposite corner"},{oldrow:8,oldcol:7,row:9,col:8,comment:"First player takes a single move, he may decide to fold his 'bridge' at the end of game"},{oldrow:6,oldcol:4,row:6,col:3,comment:"Second player makes a single move the clean up a room"},{oldrow:5,oldcol:3,row:6,col:4,comment:"First player makes a single move, the final piece in his corner is now waiting on the entry of the 'bridge'"},{oldrow:11,oldcol:15,row:9,col:13,comment:"Second player jumps with a hop in his own corner"},{oldrow:6,oldcol:4,row:12,col:16,comment:"First player makes a cool six-step-hops into his opposite corner"},{oldrow:9,oldcol:13,row:10,col:13,comment:"Second player wants to reach his 'bridge', so he makes a single move towards it"},{oldrow:11,oldcol:14,row:11,col:15,comment:"First player makes a single move"},{oldrow:10,oldcol:14,row:10,col:12,comment:"Second player just makes a hop in his own corner"},{oldrow:9,oldcol:8,row:11,col:14,comment:"First player takes a three-step-hops, now only two pieces are not in his opposite corner"},{oldrow:10,oldcol:13,row:10,col:11,comment:"Second player makes a hop towards still his 'bridge'"},{oldrow:7,oldcol:5,row:8,col:6,comment:"First player gives a single move before a long jump"},{oldrow:10,oldcol:12,row:11,col:12,comment:"Second player provides a single move"},{oldrow:8,oldcol:6,row:12,col:14,comment:"First player makes a four-step-hops into its corner"},{oldrow:11,oldcol:12,row:9,col:6,comment:"Second player gets a three-step-hops"},{oldrow:11,oldcol:14,row:10,col:14,comment:"First player makes a single move before final win"},{oldrow:9,oldcol:6,row:8,col:5,comment:"Second player makes a single move to form a new 'bridge'"},{oldrow:11,oldcol:13,row:11,col:14,comment:"First player makes a final single move, now all his pieces are firstly in his opponent's corner, this gets him win the game"}])}function p(a){try{var b=a.move,c=a.turnIndexBeforeMove,d=a.stateBeforeMove,e=b[2].set.value,f=e.oldrow,g=e.oldcol,h=e.row,i=e.col,j=d.board,k=m(f,g,h,i,c,j);if(!angular.equals(b,k))return!1}catch(l){return!1}return!0}var q={vert:[[[5,1],[5,2],[6,2],[5,3],[6,3],[7,3],[5,4],[6,4],[7,4],[8,4]],[[13,17],[12,16],[13,16],[11,15],[12,15],[13,15],[10,14],[11,14],[12,14],[13,14]]],left:[[[1,5],[2,5],[2,6],[3,5],[3,6],[3,7],[4,5],[4,6],[4,7],[4,8]],[[5,10],[5,11],[5,12],[5,13],[6,11],[6,12],[6,13],[7,12],[7,13],[8,13]]],right:[[[10,5],[11,5],[11,6],[12,5],[12,6],[12,7],[13,5],[13,6],[13,7],[13,8]],[[14,10],[14,11],[14,12],[14,13],[15,11],[15,12],[15,13],[16,12],[16,13],[17,13]]]},r=2;return{setNumPlayers:b,getInitialBoard:c,createMove:m,isMoveOk:p,getPossibleMoves:l,getExampleGame:o,getCheckerByTurn:d,getValidFromPositions:f}}),angular.module("myApp").controller("Ctrl",["$scope","$document","$log","$timeout","gameLogic",function(a,b,c,d,e){"use strict";function f(a,b,c){var d=angular.element(document.elementFromPoint(b,c));if(!v&&d.hasClass("checker")?(p=d,t=+d.attr("data-row"),u=+d.attr("data-col"),r=p[0].getBoundingClientRect()):d.hasClass("checkerCell")&&(p=d.children(),t=+d.attr("data-row"),u=+d.attr("data-col"),r=p[0].getBoundingClientRect()),"touchstart"===a&&!v&&p&&j(t,u)&&(s=r,q=p,q.parent().addClass("selected"),v=angular.element('<div class="'+p.attr("class")+' drag"></div>'),v.css("width",p[0].clientWidth+"px"),v.css("height",p[0].clientHeight+"px"),v.css("top",s.top+"px"),v.css("left",s.left+"px"),v.css("opacity",1),v.css("position","fixed"),w.append(v),q.css("display","none")),v){if("touchend"===a)g([t,u]);else{var e=r.top||s.top,f=r.left||s.left;v.css("top",e+"px"),v.css("left",f+"px")}("touchend"===a||"touchcancel"===a||"touchleave"===a)&&(v.remove(),q.parent().removeClass("selected"),q.css("display","block"),v=null,p=null)}}function g(a){j(a[0],a[1])}function h(b){a.params=b,a.board=b.stateAfterMove.board;var c=b.playersInfo.length;if(l(b.stateAfterMove))try{if(e.setNumPlayers(c),a.board=e.getInitialBoard(),m.className="","playWhite"===b.playMode)switch(c){case 4:m.className="rot_60"}else if("playBlack"===b.playMode)switch(c){case 2:m.className="rot_180";break;case 3:case 4:m.className="rot_120";break;case 6:m.className="rot_60"}}catch(f){return location.reload()}a.validFromPositions=e.getValidFromPositions(a.board,b.turnIndexAfterMove),a.isYourTurn=b.turnIndexAfterMove>=0&&b.yourPlayerIndex===b.turnIndexAfterMove,a.turnIndex=b.turnIndexAfterMove,a.isYourTurn&&""===b.playersInfo[b.yourPlayerIndex].playerId&&(a.isYourTurn=!1,d(i,500))}function i(){var b=e.getPossibleMoves(a.board,a.turnIndex);gameService.makeMove(b[Math.floor(Math.random()*b.length)])}function j(b,d){if(c.info(["Clicked on cell: ",b,d,a.selectedPosition]),!a.isYourTurn)return!1;if("?throwException"===window.location.search)throw new Error("Throwing the error because URL has '?throwException'");if(x(b,d))a.selectedPosition=[b,d];else{if(0===a.selectedPosition.length)return!1;try{var f=a.selectedPosition,g=e.createMove(f[0],f[1],b,d,a.turnIndex,a.board);a.selectedPosition=[],a.isYourTurn=!1,gameService.makeMove(g)}catch(h){return c.info(["Cell is already full in position:",b,d,h.stack]),!1}}return!0}function k(b,c){return a.board[b][c]}function l(a){if(null===a)return!0;if(a.length>0)return!1;if(0===a.length)return!0;for(var b in a)if(y.call(a,b))return!1;return!0}resizeGameAreaService.setWidthToHeight(1),a.selectedPosition=[];var m=document.getElementById("board");a.map=[[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[3,13],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[4,13],[3.5,12],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[5,13],[4.5,12],[4,11],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[6,13],[5.5,12],[5,11],[4.5,10],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[9,17],[8.5,16],[8,15],[7.5,14],[7,13],[6.5,12],[6,11],[5.5,10],[5,9],[4.5,8],[4,7],[3.5,6],[3,5],[0,0]],[[0,0],[0,0],[9.5,16],[9,15],[8.5,14],[8,13],[7.5,12],[7,11],[6.5,10],[6,9],[5.5,8],[5,7],[4.5,6],[4,5],[0,0]],[[0,0],[0,0],[0,0],[10,15],[9.5,14],[9,13],[8.5,12],[8,11],[7.5,10],[7,9],[6.5,8],[6,7],[5.5,6],[5,5],[0,0]],[[0,0],[0,0],[0,0],[0,0],[10.5,14],[10,13],[9.5,12],[9,11],[8.5,10],[8,9],[7.5,8],[7,7],[6.5,6],[6,5],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[11,13],[10.5,12],[10,11],[9.5,10],[9,9],[8.5,8],[8,7],[7.5,6],[7,5],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[12,13],[11.5,12],[11,11],[10.5,10],[10,9],[9.5,8],[9,7],[8.5,6],[8,5],[7.5,4],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[13,13],[12.5,12],[12,11],[11.5,10],[11,9],[10.5,8],[10,7],[9.5,6],[9,5],[8.5,4],[8,3],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[14,13],[13.5,12],[13,11],[12.5,10],[12,9],[11.5,8],[11,7],[10.5,6],[10,5],[9.5,4],[9,3],[8.5,2],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[15,13],[14.5,12],[14,11],[13.5,10],[13,9],[12.5,8],[12,7],[11.5,6],[11,5],[10.5,4],[10,3],[9.5,2],[9,1],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[13.5,8],[13,7],[12.5,6],[12,5],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[14,7],[13.5,6],[13,5],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[14.5,6],[14,5],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[15,5],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]],a.newposition=50,a.newpositionTop=50,a.setPagePosition=function(b,c){return a.newposition=6.7*a.map[c][b][0]-13+"%",a.newposition},a.setPagePositionTop=function(b,c){return a.newpositionTop=5.7*a.map[b][c][1]-4+"%",a.newpositionTop};var n=[],o=[];a.init=function(){n=document.getElementsByClassName("checkerCell"),o=document.getElementsByClassName("checker")};var p,q,r,s,t,u,v=null,w=angular.element(document.getElementById("gameArea"));dragAndDropService.addDragListener("gameArea",f),a.getCheckerClass=function(a,b){var c=k(a,b);return" "!==c?"checker checker_"+k(a,b):""};var x=a.isSelectable=function(b,c){for(var d=0;d<a.validFromPositions.length;d++){var e=a.validFromPositions[d];if(b===e.row&&c===e.col)return!0}return!1},y=Object.prototype.hasOwnProperty;gameService.setGame({gameDeveloperEmail:"jugalm9@gmail.com",minNumberOfPlayers:2,maxNumberOfPlayers:2,isMoveOk:e.isMoveOk,updateUI:h})}]);
//# sourceMappingURL=everything.min.js.map